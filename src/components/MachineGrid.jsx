import React, { useState } from 'react';
import './MachineGrid.css';

// YENƒ∞ AKORDƒ∞YON ITEM Bƒ∞LE≈ûENƒ∞
const AccordionItem = ({ title, content, isOpen, onToggle }) => (
  <div className={`accordion-item ${isOpen ? 'is-open' : ''}`}>
    <div className="accordion-header" onClick={onToggle}>
      <h4 className="accordion-title">{title}</h4>
      <span className="accordion-icon">{isOpen ? '‚àí' : '+'}</span>
    </div>
    {isOpen && (
      <div className="accordion-content">
        <p>{content}</p>
      </div>
    )}
  </div>
);


// MachineDetails Bile≈üeni (Akordiyonu Y√∂netir)
const MachineDetails = ({ details, machineDescription }) => {
    const [openIndex, setOpenIndex] = useState(0); 
    const toggleItem = (index) => {
        setOpenIndex(openIndex === index ? null : index);
    };

    const accordionData = [
        { title: 'Makine Hakkƒ±nda', content: machineDescription },
        ...details.map(item => ({ title: item.feature, content: item.value })),
    ];

    return (
        <div className="machine-details-accordion">
            {accordionData.map((item, index) => (
                <AccordionItem
                    key={index}
                    title={item.title}
                    content={item.content}
                    isOpen={openIndex === index}
                    onToggle={() => toggleItem(index)}
                />
            ))}
        </div>
    );
};


// MAKƒ∞NE VERƒ∞LERƒ∞ (Resim yollarƒ± / ile ba≈ülƒ±yor)
const machines = [
  { id: 1, name: 'Y√ºksek Hƒ±zlƒ± Otomatik Boyama Sistemi', description: 'B√ºy√ºk √∂l√ßekli √ºretimler i√ßin ideal, y√ºksek verimli, hƒ±zlƒ± ve tam otomasyonlu boyama √ß√∂z√ºm√ºd√ºr.', image: '/machine1.jpg', details: [{ feature: 'Kapasite', value: '1000m¬≤/saat' }, { feature: 'Kontrol Sistemi', value: 'Siemens PLC ve 15" Dokunmatik Ekran' }, { feature: 'T√ºnel Uzunluƒüu', value: '25 metre mod√ºler yapƒ±' }] },
  { id: 2, name: 'Robotik Hassas Boya Uygulayƒ±cƒ±', description: 'En karma≈üƒ±k ve √º√ß boyutlu y√ºzeylerde bile milimetrik hassasiyetle √ßalƒ±≈üan 6 eksenli robot.', image: '/machine2.jpg', details: [{ feature: 'Hassasiyet', value: '¬± 0.02 mm tekrarlanabilirlik' }, { feature: 'Eksen Sayƒ±sƒ±', value: '6 Eksenli KUKA Robot' }, { feature: 'P√ºsk√ºrtme Teknolojisi', value: 'Y√ºksek verimli elektrostatik' }] },
  { id: 3, name: 'Mod√ºler UV K√ºrleme T√ºneli', description: 'UV boyalƒ± √ºr√ºnlerin anƒ±nda ve kusursuz kurumasƒ±nƒ± saƒülayan son nesil enerji verimli t√ºnel sistemi.', image: '/machine4.jpg', details: [{ feature: 'K√ºrleme Hƒ±zƒ±', value: '15m/dakika' }, { feature: 'Lamba √ñmr√º', value: '20.000 saat (LED UV)' }, { feature: 'Soƒüutma Sistemi', value: 'Entegre aktif hava soƒüutma' }] },
];


function MachineCard({ machine }) {
  // KRƒ∞Tƒ∞K: Her kart kendi state'ini y√∂netir.
  const [showDetails, setShowDetails] = useState(false); 

  const toggleDetails = () => {
    setShowDetails(!showDetails);
  };

  return (
    <div className="machine-card">
      
      <div 
        className="machine-image-wrapper" 
        // üí• KRƒ∞Tƒ∞K D√úZELTME: Resim yolu BASE_URL ile d√ºzeltildi
        style={{ backgroundImage: `url(${import.meta.env.BASE_URL}${machine.image.substring(1)})` }} 
        aria-label={machine.name}
      ></div>
      
      <div className="card-content"> 
        <h3>{machine.name}</h3>
        
        <button className="details-button" onClick={toggleDetails}>
          {showDetails ? 'Detaylarƒ± Kapat ‚¨ÜÔ∏è' : '√ñzellikleri ƒ∞ncele ‚¨áÔ∏è'}
        </button>
      </div>

      {showDetails && <MachineDetails 
          details={machine.details} 
          machineDescription={machine.description}
      />}
    </div>
  );
}

function MachineGrid({ isFullPage }) { 
  return (
    <div className="machine-grid-section">
      <div className="container">
        {!isFullPage && <h2>√úr√ºn Yelpazemiz</h2>} 
        
        <div className="machine-grid">
          {machines.map((machine) => (
            <MachineCard key={machine.id} machine={machine} /> 
          ))}
        </div>
      </div>
    </div>
  );
}

export default MachineGrid;